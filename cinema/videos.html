<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PIXELSTORTION // VISUAL ARCHIVE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <style>
        :root {
            --neon-green: #00ff41;
            --neon-dim: rgba(0, 255, 65, 0.1);
            --bg-dark: #050505;
        }

        body {
            background-color: var(--bg-dark);
            color: #e0e0e0;
            font-family: 'Space Grotesk', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        .font-mono-custom { font-family: 'Courier Prime', monospace; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; border-left: 1px solid #222; }
        ::-webkit-scrollbar-thumb { background: #333; border: 1px solid #000; }
        ::-webkit-scrollbar-thumb:hover { background: var(--neon-green); }

        /* Glitch Text */
        .glitch-text { position: relative; }
        .glitch-text::before, .glitch-text::after {
            content: attr(data-text); position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.8;
        }
        .glitch-text::before { left: 2px; text-shadow: -1px 0 red; clip-path: inset(0 0 0 0); animation: glitch-anim 2s infinite linear alternate-reverse; }
        .glitch-text::after { left: -2px; text-shadow: 1px 0 var(--neon-green); clip-path: inset(0 0 0 0); animation: glitch-anim 3s infinite linear alternate-reverse; }
        @keyframes glitch-anim {
            0% { clip-path: inset(10% 0 80% 0); } 20% { clip-path: inset(80% 0 10% 0); } 100% { clip-path: inset(30% 0 60% 0); }
        }

        /* Scanlines */
        .scanlines {
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1));
            background-size: 100% 4px;
            position: fixed; inset: 0; pointer-events: none; z-index: 50;
        }

        /* Protocol Buttons (Character List) */
        .protocol-btn {
            display: flex; align-items: center; gap: 12px;
            text-align: left; padding: 12px 16px;
            border-left: 2px solid transparent;
            transition: all 0.2s ease; opacity: 0.6;
            font-family: 'Courier Prime', monospace; font-size: 11px; letter-spacing: 1px;
            background: #080808;
        }
        .protocol-btn:hover { background: #111; opacity: 1; padding-left: 20px; }
        .protocol-btn.active {
            border-left: 2px solid var(--neon-green);
            background: linear-gradient(90deg, var(--neon-dim) 0%, transparent 100%);
            color: var(--neon-green); opacity: 1; padding-left: 20px;
            text-shadow: 0 0 5px var(--neon-green);
        }
        
        /* Character Images */
        .protocol-img {
            width: 36px; height: 36px; object-fit: cover; border-radius: 2px;
            filter: grayscale(100%); transition: all 0.3s ease; border: 1px solid #333;
        }
        .protocol-btn.active .protocol-img, .protocol-btn:hover .protocol-img {
            filter: grayscale(0%); border-color: var(--neon-green);
        }

        /* Track List */
        .track-item {
            padding: 12px; border-bottom: 1px solid #1a1a1a; cursor: pointer;
            transition: all 0.2s; display: flex; align-items: center; gap: 12px;
        }
        .track-item:hover { background: #111; }
        .track-item.active { background: #1a1a1a; border-left: 2px solid var(--neon-green); }
        .track-item.active .track-idx { color: var(--neon-green); }

        /* Control Buttons */
        .control-btn {
            width: 45px; height: 45px; border-radius: 50%;
            border: 1px solid #333; background: #000; color: #888;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
        }
        .control-btn:hover { border-color: var(--neon-green); color: var(--neon-green); box-shadow: 0 0 10px var(--neon-dim); }
        .control-btn:active { transform: scale(0.95); }

        /* Fullscreen Mode */
        body.fullscreen-mode #sidebar-left, 
        body.fullscreen-mode #sidebar-right,
        body.fullscreen-mode .header-bar { display: none !important; }
        body.fullscreen-mode #main-container { padding: 0; }
        body.fullscreen-mode #video-frame { position: fixed; inset: 0; z-index: 100; height: 100vh; width: 100vw; border: none; max-height: none; }
        body.fullscreen-mode #fs-exit-btn { display: flex; }

        /* Mobile Optimization */
        @media (max-width: 768px) {
            body { flex-direction: column; }
            
            /* Top Character Scroller */
            #sidebar-left { 
                width: 100%; height: auto; border-right: none; border-bottom: 1px solid #222;
                flex-direction: row; overflow-x: auto; overflow-y: hidden;
                padding: 0; z-index: 30;
                scrollbar-width: none; /* Hide scrollbar for cleaner look */
            }
            #sidebar-left::-webkit-scrollbar { display: none; }
            
            /* Hide the large "ARCHIVE" header on mobile */
            .header-section { display: none !important; }
            .footer-section { display: none !important; }

            #protocol-list { 
                display: flex; flex-direction: row; padding: 0; width: max-content;
            }
            
            .protocol-btn {
                width: auto; padding: 8px 12px; border-left: none; border-bottom: 2px solid transparent;
                background: #000; gap: 8px;
            }
            .protocol-btn .protocol-text { display: none; } /* Hide text, show only icon on mobile? Optional. Keeping text for now. */
            
            .protocol-btn.active {
                border-left: none; border-bottom: 2px solid var(--neon-green); padding-left: 12px;
                background: linear-gradient(0deg, var(--neon-dim) 0%, transparent 100%);
            }

            /* Main Content */
            #main-container { height: 100%; display: flex; flex-direction: column; }
            
            /* Video Frame - Takes maximum space */
            #video-frame { 
                flex: 1; /* Fills available vertical space */
                max-height: none; 
                width: 100%;
            }
            
            /* Bottom Controls */
            .header-bar { 
                height: auto; min-height: 80px; padding: 12px; 
                background: #080808; border-top: 1px solid #222;
                display: flex; flex-wrap: wrap; justify-content: center;
            }
            
            .header-bar > div { width: auto; }
            .mobile-title-container { width: 100% !important; text-align: center; margin-bottom: 10px; }
            
            #sidebar-right { display: none; } /* Hide track list on mobile */
        }
    </style>
</head>
<body class="flex flex-col md:flex-row h-screen overflow-hidden bg-black text-white">

    <div class="scanlines"></div>

    <div id="sidebar-left" class="w-full md:w-64 bg-[#080808] border-r border-[#222] flex flex-col z-20 flex-shrink-0">
        <div class="header-section p-6 border-b border-[#222]">
            <h1 class="text-lg font-bold font-mono-custom text-white glitch-text" data-text="ARCHIVE">ARCHIVE</h1>
            <p class="text-[9px] text-gray-500 mt-1 font-mono-custom tracking-widest">CLEARANCE: 4</p>
        </div>
        
        <div class="flex-1 overflow-y-auto" id="protocol-list">
            </div>
        
        <div class="footer-section p-4 border-t border-[#222] space-y-2">
            <button onclick="shuffleGlobal()" class="w-full py-2 border border-[#333] text-[10px] hover:border-green-500 hover:text-green-500 transition-colors font-mono-custom">
                GLOBAL SHUFFLE
            </button>
        </div>
    </div>

    <div id="main-container" class="flex-1 flex flex-col relative bg-[#050505]">
        
        <div id="video-frame" class="flex-1 relative bg-black flex items-center justify-center overflow-hidden border-b border-[#222]">
            <div id="youtube-player" class="w-full h-full absolute inset-0"></div>
            
            <div id="interaction-shield" class="absolute inset-0 z-50 pointer-events-auto" style="background: transparent;" onclick="togglePlay()"></div>
            
            <button id="fs-exit-btn" onclick="toggleFullscreen()" class="hidden absolute top-4 right-4 z-50 bg-black/80 text-white p-3 rounded-full border border-red-500 hover:bg-red-900/50 transition-colors cursor-pointer shadow-lg">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <div class="header-bar h-24 bg-[#080808] border-t border-[#222] flex items-center justify-between px-6 z-20 flex-shrink-0">
            
            <div class="mobile-title-container md:hidden">
                <div id="current-title-mobile" class="text-xs font-mono-custom text-green-500 truncate">INITIALIZING...</div>
            </div>

            <div class="hidden md:block w-1/3">
                <div class="text-[10px] text-green-500 font-mono-custom mb-1">CURRENT FEED</div>
                <div id="current-title" class="text-sm font-bold truncate text-gray-300">INITIALIZING...</div>
            </div>

            <div class="flex items-center gap-6 justify-center w-full md:w-auto">
                <button class="control-btn" onclick="prevTrack()" title="Previous">
                    <span class="material-symbols-outlined">skip_previous</span>
                </button>
                <button class="control-btn" onclick="togglePlay()" title="Play/Pause" style="width: 60px; height: 60px; border-color: #444;">
                    <span id="play-icon" class="material-symbols-outlined text-4xl">play_arrow</span>
                </button>
                <button class="control-btn" onclick="nextTrack()" title="Next">
                    <span class="material-symbols-outlined">skip_next</span>
                </button>
            </div>

            <div class="flex items-center justify-end gap-3 w-1/3 hidden md:flex">
                <button class="text-xs font-mono-custom text-gray-500 hover:text-white px-3 py-1 border border-[#222] rounded hover:border-gray-500 transition-colors" onclick="toggleResolution()">SD/HD</button>
                <button class="text-gray-500 hover:text-green-500 transition-colors p-2" onclick="toggleFullscreen()" title="Fullscreen">
                    <span class="material-symbols-outlined text-2xl">fullscreen</span>
                </button>
            </div>
        </div>
    </div>

    <div id="sidebar-right" class="w-full md:w-64 bg-[#080808] border-l border-[#222] flex flex-col z-20 flex-shrink-0 hidden md:flex">
        <div class="p-4 border-b border-[#222] bg-[#0a0a0a]">
            <h2 class="text-xs font-bold text-gray-400 font-mono-custom tracking-widest">FEED SELECTION</h2>
        </div>
        <div class="flex-1 overflow-y-auto" id="track-list">
            </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        // Image Guidelines: Use 200x200px square images for best results.
        const PROTOCOLS = [
            { 
                id: 'isla', name: 'ISLA', img: 'https://github.com/NJsalubrious/pixelstortion-assets/blob/main/Isla_misc/Images/Isla_Profile.jpg?raw=true', 
                tracks: [
                    { id: "MhEeDcdscrs", title: "Polished Vomit" },
                    { id: "qbFxG7sK0pE", title: "Peek-A-Boo" },
                    { id: "sXKAs0U8eO8", title: "Isla Hates Married Bankers" },
                    { id: "0F_prk5dGC4", title: "I Built A Box" },
                    { id: "nVKkwb4EnRc", title: "Burning Bridges" },
                    { id: "_gvv_W5_x10", title: "Broken Edge" },
                    { id: "0tzOaukuBns", title: "This Isn't Therapy" },
                    { id: "6bwKDegeBHU", title: "Drop From The Fourth" },
                    { id: "GFkK21BdE9o", title: "The Porcelain Lie" },
                    { id: "nk4Re7OjTTM", title: "Memory Under Water" },
                    { id: "ey20cJsY82M", title: "Raise The Fourth" },
                    { id: "dK8mqLNRZ2Q", title: "Intro: Shiny Headed Man" },
                    { id: "UFZeKCcSMoE", title: "Shiny Headed Radio Man" },
                    { id: "-3m2_zUNBlo", title: "Stanmore Farewell" },
                    { id: "NwqHLFYR1mA", title: "Don't Wake Him Yet" },
                    { id: "Y4VC6mh37NI", title: "What You Don't See" },
                    { id: "Aw2ZAkxp6b0", title: "Give It Back" }
                ]
            },
            { 
                id: 'ethel', name: 'ETHEL', img: 'https://github.com/NJsalubrious/pixelstortion-assets/blob/main/Isla_misc/Images/Ethel_Profile.jpg?raw=true',
                tracks: [
                    { id: "YKQk4G_XJ1w", title: "Introduction" },
                    { id: "zHWwhom80go", title: "The Drop 1" },
                    { id: "lV4572kA1RE", title: "Intro: The Drop" },
                    { id: "K0ILO8MwX4Y", title: "The Drop 2" },
                    { id: "VKJaSC_-0sM", title: "Intro: Polished Vomit" },
                    { id: "Jl8T2gWUVMY", title: "Intro: Dominic's Intent" },
                    { id: "Wvu0JIV1ePQ", title: "Intro: Ride" },
                    { id: "0sgcZRtPO6s", title: "Ride" },
                    { id: "95wQ9YZUbcA", title: "Intro: Grief" },
                    { id: "PMy76HBgpL8", title: "Grief" },
                    { id: "IuyKvsxwBgY", title: "Intro: Gotta Move" },
                    { id: "06qE_-OeIT0", title: "Gotta Move" },
                    { id: "oPOEgISVQYk", title: "Intro: Won't Break" },
                    { id: "fJNMlT7UeW0", title: "Won't Break Where Others End" },
                    { id: "8UvIT2TgY_Y", title: "Intro: Big House" },
                    { id: "mj9MGf-VzJY", title: "Big House" },
                    { id: "dIh_CL7h7zU", title: "Intro: Northern Road" },
                    { id: "P19KBEQdVjQ", title: "Northern Road" },
                    { id: "V0hvxqMWcnE", title: "Intro: Normal?!" },
                    { id: "8GCXnOQI60g", title: "Normal?!" }
                ]
            },
            { 
                id: 'dominic', name: 'DOMINIC', img: 'https://github.com/NJsalubrious/pixelstortion-assets/blob/main/Isla_misc/Images/Dominic_Profile.jpg?raw=true',
                tracks: [
                    { id: "8rvIVBLZg2o", title: "Structural Psychopathy" },
                    { id: "f8o7zb3F-Xk", title: "For You!!!" },
                    { id: "YkQOXPzYkkU", title: "Hero Complex" },
                    { id: "Ghg7pC3ms3I", title: "Nothing True" },
                    { id: "n6OgobffCzo", title: "You Will Thank Me Later" },
                    { id: "t6vLU0uqIfc", title: "No Sparrow Caught Mid Flight" },
                    { id: "kB5lGHjUqUY", title: "Intro: Escape" },
                    { id: "6eZwBGXGSO4", title: "Dominic's Escape" }
                ]
            },
            { 
                id: 'sticky', name: 'STICKY', img: 'https://via.placeholder.com/200/333300/ffffff?text=STICKY',
                tracks: [
                    { id: "iTOKsLS3jhM", title: "Red Stick" },
                    { id: "s9Z8dgRk-Q8", title: "Make A Mistake On Purpose" },
                    { id: "CaBcQ2aSjog", title: "Ants On The Vine" },
                    { id: "VC6vQGPyF4c", title: "Platform 18" }
                ]
            },
            { 
                id: 'kinley', name: 'KINLEY', img: 'https://via.placeholder.com/200/333333/ffffff?text=KINLEY',
                tracks: [
                    { id: "Ac3cRsmjKpE", title: "Kinley (Guilt Money)" },
                    { id: "ZAhqNWTHTGU", title: "Clipboard Man" },
                    { id: "Fs7BXBOVnvY", title: "Rattled" },
                    { id: "WZ3P96AJfEc", title: "Harms Ghost" }
                ]
            }
        ];

        let player;
        let currentProtocolIdx = 0;
        let currentTrackIdx = 0;
        let isPlaying = false;
        let isLowRes = false;

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('youtube-player', {
                height: '100%',
                width: '100%',
                videoId: PROTOCOLS[0].tracks[0].id,
                playerVars: {
                    'controls': 0, 'showinfo': 0, 'rel': 0, 
                    'modestbranding': 1, 'iv_load_policy': 3, 'fs': 0, 'disablekb': 1
                },
                events: { 'onReady': onPlayerReady, 'onStateChange': onPlayerStateChange }
            });
        }

        function onPlayerReady(event) {
            renderProtocols();
            loadProtocol(0); 
        }

        function onPlayerStateChange(event) {
            const btn = document.getElementById('play-icon');
            if (event.data == YT.PlayerState.PLAYING) {
                btn.innerText = 'pause';
                isPlaying = true;
            } else {
                btn.innerText = 'play_arrow';
                isPlaying = false;
            }
            // AUTO-ADVANCE
            if (event.data == YT.PlayerState.ENDED) {
                nextTrack(); 
            }
        }

        function renderProtocols() {
            const container = document.getElementById('protocol-list');
            container.innerHTML = PROTOCOLS.map((p, idx) => `
                <button onclick="loadProtocol(${idx})" id="proto-btn-${idx}" class="protocol-btn w-full">
                    <img src="${p.img}" class="protocol-img" alt="${p.name}">
                    <span class="protocol-text font-bold text-gray-400 group-hover:text-white">${p.name}</span>
                </button>
            `).join('');
        }

        function loadProtocol(idx) {
            currentProtocolIdx = idx;
            currentTrackIdx = 0; 
            document.querySelectorAll('.protocol-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`proto-btn-${idx}`).classList.add('active');
            renderTrackList();
            loadTrack(currentTrackIdx);
        }

        function renderTrackList() {
            const container = document.getElementById('track-list');
            const tracks = PROTOCOLS[currentProtocolIdx].tracks;
            container.innerHTML = tracks.map((t, i) => `
                <div onclick="loadTrack(${i})" class="track-item group" id="track-row-${i}">
                    <span class="track-idx font-mono-custom text-[10px] text-gray-600 group-hover:text-white">${(i + 1).toString().padStart(2, '0')}</span>
                    <div class="flex-1"><div class="text-[11px] text-gray-300 font-bold truncate">${t.title.toUpperCase()}</div></div>
                    <span class="material-symbols-outlined text-[14px] text-gray-700 opacity-0 group-hover:opacity-100">play_circle</span>
                </div>
            `).join('');
        }

        function loadTrack(trackIdx) {
            currentTrackIdx = trackIdx;
            const track = PROTOCOLS[currentProtocolIdx].tracks[trackIdx];
            player.loadVideoById(track.id);
            const title = track.title.toUpperCase();
            document.getElementById('current-title').innerText = title;
            document.getElementById('current-title-mobile').innerText = title;
            document.querySelectorAll('.track-item').forEach(el => el.classList.remove('active'));
            const activeRow = document.getElementById(`track-row-${trackIdx}`);
            if(activeRow) { activeRow.classList.add('active'); activeRow.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
        }

        function togglePlay() { if(isPlaying) player.pauseVideo(); else player.playVideo(); }
        
        function nextTrack() {
            const tracks = PROTOCOLS[currentProtocolIdx].tracks;
            // Go to next track, or loop to start
            let nextIdx = (currentTrackIdx + 1) % tracks.length;
            loadTrack(nextIdx);
        }
        
        function prevTrack() {
            const tracks = PROTOCOLS[currentProtocolIdx].tracks;
            let prevIdx = (currentTrackIdx - 1 + tracks.length) % tracks.length;
            loadTrack(prevIdx);
        }
        
        function toggleFullscreen() { document.body.classList.toggle('fullscreen-mode'); }
        
        function toggleResolution() {
            if(!isLowRes) { player.setPlaybackQuality('small'); isLowRes = true; } 
            else { player.setPlaybackQuality('hd1080'); isLowRes = false; }
        }
        
        function shuffleGlobal() {
            const rProto = Math.floor(Math.random() * PROTOCOLS.length);
            loadProtocol(rProto);
            const rTrack = Math.floor(Math.random() * PROTOCOLS[rProto].tracks.length);
            setTimeout(() => loadTrack(rTrack), 500);
        }
    </script>
</body>
</html>
