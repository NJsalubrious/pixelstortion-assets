<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIXELSTORTION // VISUAL ARCHIVE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <style>
        :root {
            --neon-green: #00ff41;
            --neon-dim: rgba(0, 255, 65, 0.2);
            --bg-dark: #050505;
            --panel-bg: rgba(10, 10, 10, 0.95);
        }

        body {
            background-color: var(--bg-dark);
            color: #e0e0e0;
            font-family: 'Space Grotesk', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        .font-mono-custom {
            font-family: 'Courier Prime', monospace;
        }

        /* Glitch Text */
        .glitch-text {
            position: relative;
        }

        .glitch-text::before,
        .glitch-text::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.8;
        }

        .glitch-text::before {
            left: 2px;
            text-shadow: -1px 0 red;
            clip-path: inset(0 0 0 0);
            animation: glitch-anim 2s infinite linear alternate-reverse;
        }

        .glitch-text::after {
            left: -2px;
            text-shadow: 1px 0 var(--neon-green);
            clip-path: inset(0 0 0 0);
            animation: glitch-anim 3s infinite linear alternate-reverse;
        }

        @keyframes glitch-anim {
            0% {
                clip-path: inset(10% 0 80% 0);
            }

            20% {
                clip-path: inset(80% 0 10% 0);
            }

            40% {
                clip-path: inset(40% 0 50% 0);
            }

            60% {
                clip-path: inset(10% 0 20% 0);
            }

            80% {
                clip-path: inset(70% 0 5% 0);
            }

            100% {
                clip-path: inset(30% 0 60% 0);
            }
        }

        /* Scanlines */
        .scanlines {
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.1) 50%, rgba(0, 0, 0, 0.1));
            background-size: 100% 4px;
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 50;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-track {
            background: #000;
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 2px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--neon-green);
        }

        /* UI Elements */
        .protocol-btn {
            text-align: left;
            padding: 12px 16px;
            border-left: 2px solid transparent;
            transition: all 0.2s ease;
            opacity: 0.5;
            font-family: 'Courier Prime', monospace;
            font-size: 11px;
            letter-spacing: 1px;
        }

        .protocol-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            opacity: 0.8;
            padding-left: 20px;
        }

        .protocol-btn.active {
            border-left: 2px solid var(--neon-green);
            background: linear-gradient(90deg, var(--neon-dim) 0%, transparent 100%);
            color: var(--neon-green);
            opacity: 1;
            padding-left: 20px;
            text-shadow: 0 0 5px var(--neon-green);
        }

        .track-item {
            padding: 10px 12px;
            border-bottom: 1px solid #1a1a1a;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .track-item:hover {
            background: #111;
        }

        .track-item.active {
            background: #1a1a1a;
            border-left: 2px solid var(--neon-green);
        }

        .track-item.active .track-idx {
            color: var(--neon-green);
        }

        .control-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 1px solid #333;
            background: #000;
            color: #888;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .control-btn:hover {
            border-color: var(--neon-green);
            color: var(--neon-green);
            box-shadow: 0 0 10px var(--neon-dim);
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        /* Fullscreen Mode */
        body.fullscreen-mode #sidebar-left,
        body.fullscreen-mode #sidebar-right,
        body.fullscreen-mode .header-bar {
            display: none !important;
        }

        body.fullscreen-mode #main-container {
            padding: 0;
        }

        body.fullscreen-mode #video-frame {
            position: fixed;
            inset: 0;
            z-index: 100;
            height: 100vh;
            width: 100vw;
            max-height: none;
            border: none;
        }

        body.fullscreen-mode #fs-exit-btn {
            display: flex;
        }
    </style>
</head>

<body class="flex flex-col md:flex-row h-screen overflow-hidden bg-black text-white">

    <div class="scanlines"></div>

    <div id="sidebar-left" class="w-full md:w-56 bg-[#080808] border-r border-[#222] flex flex-col z-20 flex-shrink-0">
        <div class="p-6 border-b border-[#222]">
            <h1 class="text-lg font-bold font-mono-custom text-white glitch-text" data-text="ARCHIVE">ARCHIVE</h1>
            <p class="text-[9px] text-gray-500 mt-1 font-mono-custom tracking-widest">CLEARANCE: 4</p>
        </div>
        <div class="flex-1 overflow-y-auto py-2" id="protocol-list"></div>
        <div class="p-4 border-t border-[#222] space-y-2">
            <button onclick="shuffleGlobal()"
                class="w-full py-2 border border-[#333] text-[10px] hover:border-green-500 hover:text-green-500 transition-colors font-mono-custom">
                GLOBAL SHUFFLE
            </button>
        </div>
    </div>

    <div id="main-container" class="flex-1 flex flex-col relative bg-[#050505]">

        <div id="video-frame"
            class="flex-1 relative bg-black flex items-center justify-center overflow-hidden border-b border-[#222]">

            <div id="youtube-player" class="w-full h-full absolute inset-0"></div>

            <div class="absolute inset-0 z-10 pointer-events-none" style="box-shadow: inset 0 0 100px rgba(0,0,0,0.8);">
            </div>

            <button id="fs-exit-btn" onclick="toggleFullscreen()"
                class="hidden absolute top-6 right-6 z-50 bg-black/80 text-white p-3 rounded-full border border-red-500 hover:bg-red-900/50 transition-colors">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <div
            class="header-bar h-20 bg-[#080808] border-t border-[#222] flex items-center justify-between px-6 z-20 flex-shrink-0">

            <div class="hidden md:block w-1/3">
                <div class="text-[10px] text-green-500 font-mono-custom mb-1">CURRENT FEED</div>
                <div id="current-title" class="text-sm font-bold truncate text-gray-300">INITIALIZING...</div>
            </div>

            <div class="flex items-center gap-4">
                <button class="control-btn" onclick="prevTrack()" title="Previous">
                    <span class="material-symbols-outlined">skip_previous</span>
                </button>
                <button class="control-btn" onclick="togglePlay()" title="Play/Pause"
                    style="width: 55px; height: 55px; border-color: #444;">
                    <span id="play-icon" class="material-symbols-outlined text-3xl">play_arrow</span>
                </button>
                <button class="control-btn" onclick="nextTrack()" title="Next">
                    <span class="material-symbols-outlined">skip_next</span>
                </button>
            </div>

            <div class="flex items-center justify-end gap-3 w-1/3">
                <button
                    class="text-xs font-mono-custom text-gray-500 hover:text-white px-3 py-1 border border-[#222] rounded hover:border-gray-500 transition-colors"
                    onclick="toggleResolution()">SD/HD</button>
                <button class="text-gray-500 hover:text-green-500 transition-colors" onclick="toggleFullscreen()"
                    title="Fullscreen">
                    <span class="material-symbols-outlined">fullscreen</span>
                </button>
            </div>
        </div>
    </div>

    <div id="sidebar-right"
        class="w-full md:w-64 bg-[#080808] border-l border-[#222] flex flex-col z-20 flex-shrink-0 hidden md:flex">
        <div class="p-4 border-b border-[#222] bg-[#0a0a0a]">
            <h2 class="text-xs font-bold text-gray-400 font-mono-custom tracking-widest">FEED SELECTION</h2>
        </div>
        <div class="flex-1 overflow-y-auto" id="track-list">
            <div class="p-4 text-[10px] text-gray-600 font-mono-custom text-center mt-10">
                SELECT A PROTOCOL TO LOAD FEEDS
            </div>
        </div>
    </div>

    <script>
        // --- DATA ---
        const PLAYLISTS = [
            { id: 'isla', name: 'ISLA PROTOCOL', listId: 'PLCznJy93VqGAzZT1mND7Kl2sBm7gXYjY5' },
            { id: 'ethel', name: 'ETHEL PROTOCOL', listId: 'PLCznJy93VqGD93s7ESR0NMfJJAvxPCajr' },
            { id: 'dominic', name: 'DOMINIC PROTOCOL', listId: 'PLCznJy93VqGAYV-5ITfKlaSwxF-rGDl_4' },
            { id: 'sticky', name: 'STICKY PROTOCOL', listId: 'PLCznJy93VqGDqVB53a_p79ry132TYe7Ql' },
            { id: 'kinley', name: 'KINLEY PROTOCOL', listId: 'PLCznJy93VqGAyLossoIWD15Lx_SRAcRu7' }
        ];

        let player;
        let isPlaying = false;
        let currentPlaylistId = '';
        let isLowRes = false;

        // --- INIT ---
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('youtube-player', {
                height: '100%',
                width: '100%',
                playerVars: {
                    'controls': 0, // HIDE YOUTUBE CONTROLS
                    'showinfo': 0,
                    'rel': 0,
                    'modestbranding': 1,
                    'iv_load_policy': 3,
                    'fs': 0,
                    'disablekb': 1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            renderProtocols();
            // Load first playlist by default
            loadPlaylist(0);
        }

        function onPlayerStateChange(event) {
            const btn = document.getElementById('play-icon');
            if (event.data == YT.PlayerState.PLAYING) {
                btn.innerText = 'pause';
                isPlaying = true;
                updateTrackInfo();
            } else {
                btn.innerText = 'play_arrow';
                isPlaying = false;
            }
        }

        // --- CORE FUNCTIONS ---

        function renderProtocols() {
            const container = document.getElementById('protocol-list');
            container.innerHTML = PLAYLISTS.map((pl, idx) => `
                <button onclick="loadPlaylist(${idx})" id="proto-btn-${idx}" class="protocol-btn w-full">
                    ${pl.name}
                </button>
            `).join('');
        }

        function loadPlaylist(idx) {
            // Update UI
            document.querySelectorAll('.protocol-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`proto-btn-${idx}`).classList.add('active');

            currentPlaylistId = PLAYLISTS[idx].listId;

            // Load List
            player.loadPlaylist({
                listType: 'playlist',
                list: currentPlaylistId
            });

            // Generate Track List (Simulated since we lack API Key)
            setTimeout(generateTrackListUI, 1500);
        }

        function generateTrackListUI() {
            // We ask the player how many videos are in the queue
            const playlist = player.getPlaylist();
            const container = document.getElementById('track-list');

            if (!playlist || playlist.length === 0) {
                container.innerHTML = '<div class="p-4 text-xs text-gray-600 font-mono-custom">LOADING DATA...</div>';
                setTimeout(generateTrackListUI, 1000); // Retry
                return;
            }

            container.innerHTML = playlist.map((vidId, i) => `
                <div onclick="playTrackByIndex(${i})" class="track-item group" id="track-row-${i}">
                    <span class="track-idx font-mono-custom text-[10px] text-gray-600 group-hover:text-white">
                        ${(i + 1).toString().padStart(2, '0')}
                    </span>
                    <div class="flex-1">
                        <div class="text-[11px] text-gray-300 font-bold">VIDEO FILE ${i + 1}</div>
                        <div class="text-[9px] text-gray-600 font-mono-custom">ID: ${vidId.substring(0, 8)}...</div>
                    </div>
                    <span class="material-symbols-outlined text-[14px] text-gray-700 opacity-0 group-hover:opacity-100">play_circle</span>
                </div>
            `).join('');

            updateTrackInfo();
        }

        function updateTrackInfo() {
            const idx = player.getPlaylistIndex();

            // Update Title
            const titleEl = document.getElementById('current-title');
            titleEl.innerText = `PLAYING FILE SEQUENCE: ${(idx + 1).toString().padStart(2, '0')}`;

            // Update List Highlight
            document.querySelectorAll('.track-item').forEach(el => el.classList.remove('active'));
            const activeRow = document.getElementById(`track-row-${idx}`);
            if (activeRow) {
                activeRow.classList.add('active');
                activeRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // --- CONTROLS ---

        function togglePlay() {
            if (isPlaying) player.pauseVideo();
            else player.playVideo();
        }

        function nextTrack() {
            player.nextVideo();
        }

        function prevTrack() {
            player.previousVideo();
        }

        function playTrackByIndex(index) {
            player.playVideoAt(index);
        }

        function toggleFullscreen() {
            document.body.classList.toggle('fullscreen-mode');
        }

        function toggleResolution() {
            if (!isLowRes) {
                player.setPlaybackQuality('small');
                isLowRes = true;
            } else {
                player.setPlaybackQuality('hd1080');
                isLowRes = false;
            }
        }

        function shuffleGlobal() {
            const randomListIdx = Math.floor(Math.random() * PLAYLISTS.length);
            loadPlaylist(randomListIdx);
            setTimeout(() => {
                player.setShuffle(true);
                player.playVideoAt(0);
            }, 1000);
        }

    </script>
</body>

</html>
