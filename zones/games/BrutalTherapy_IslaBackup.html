<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRUTAL THERAPY: SESSION 44-G</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Syncopate:wght@700&display=swap');

        :root {
            --brutal-red: #ff0000;
            --brutal-black: #050505;
            --brutal-white: #ffffff;
        }

        body {
            background-color: var(--brutal-black);
            color: var(--brutal-white);
            font-family: 'JetBrains Mono', monospace;
            overflow: hidden;
            height: 100vh;
        }

        .syncopate { font-family: 'Syncopate', sans-serif; }

        .scanner-line {
            height: 2px;
            background: var(--brutal-red);
            width: 100%;
            position: absolute;
            top: 0;
            z-index: 50;
            animation: scan 4s linear infinite;
            box-shadow: 0 0 10px var(--brutal-red);
        }

        @keyframes scan {
            0% { top: 0; }
            100% { top: 100%; }
        }

        .brutal-border {
            border: 2px solid var(--brutal-white);
            box-shadow: 4px 4px 0 var(--brutal-red);
        }

        .glitch-text {
            animation: glitch 1s infinite linear alternate-reverse;
        }

        @keyframes glitch {
            0% { text-shadow: 2px 0 red, -2px 0 blue; }
            50% { text-shadow: -2px 0 red, 2px 0 blue; }
            100% { text-shadow: 2px 0 blue, -2px 0 red; }
        }

        .stress-bar { transition: width 0.4s cubic-bezier(0.19, 1, 0.22, 1); }

        .btn-choice {
            background: var(--brutal-black);
            border: 2px solid var(--brutal-white);
            transition: all 0.1s;
        }

        .btn-choice:hover {
            background: var(--brutal-white);
            color: var(--brutal-black);
            box-shadow: 8px 8px 0 var(--brutal-red);
        }

        .screen { display: none; }
        .screen.active { display: flex; }

        .isla-visual {
            filter: grayscale(1) contrast(1.4) brightness(0.8);
            mix-blend-mode: screen;
        }
    </style>
</head>
<body class="flex flex-col h-screen">
    <div class="scanner-line"></div>

    <header class="p-6 border-b-4 border-white flex justify-between items-center bg-black/95 z-40">
        <div class="flex items-center gap-6">
            <span class="material-symbols-outlined text-red-600 text-5xl">psychiatry</span>
            <div>
                <h1 class="text-4xl font-black uppercase syncopate italic leading-none glitch-text">Brutal Therapy</h1>
                <p class="text-[10px] uppercase font-bold text-red-600 tracking-[0.4em] mt-2">Dossier Access // Subject: ISLA</p>
            </div>
        </div>
        <div class="flex items-center gap-8">
            <div class="flex flex-col items-end gap-1">
                <span id="hud-trust" class="text-[10px] font-black uppercase text-white/50">Stability: 50%</span>
                <div class="w-64 h-2 bg-white/10 border border-white/20">
                    <div id="trust-bar" class="h-full bg-red-600" style="width: 50%"></div>
                </div>
            </div>
            <div id="hud-time" class="text-2xl font-black italic">03:00</div>
            <div id="hud-strikes" class="text-2xl font-black text-red-600">0/2</div>
        </div>
    </header>

    <main class="flex-grow relative flex flex-col items-center justify-center p-8">
        
        <section id="screen-intro" class="screen active flex-col items-center justify-center max-w-4xl gap-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 w-full">
                <div class="brutal-border bg-black/80 p-8">
                    <h2 class="text-2xl font-black italic uppercase border-b-2 border-red-600 mb-4">Operational Protocol</h2>
                    <p class="text-sm font-bold leading-relaxed">Isla possesses her father's (High Court Judge) IQ. Dominic's $20B empire is masked by construction covers. Do not allow peacetime empathy to invalidate her evidence.</p>
                </div>
                <button id="btn-start" class="btn-choice p-6 text-2xl font-black italic uppercase bg-red-600 text-white">Start Session</button>
            </div>
        </section>

        <section id="screen-game" class="screen flex-col w-full max-w-6xl gap-6 h-full">
            <div class="flex-grow flex gap-6 overflow-hidden">
                <div class="w-1/3 flex flex-col gap-6">
                    <div class="brutal-border bg-black aspect-square overflow-hidden">
                        <img src="https://dash.cloudflare.com/40ac45ea6cc627df95862ef4e1ce0c56/r2/default/buckets/pixelstortion-assets/objects/images_islaGameV1%2FIMG_SUBJ_01.jpg" class="w-full h-full object-cover isla-visual">
                    </div>
                </div>
                <div class="flex-grow flex flex-col gap-6">
                    <div class="flex-grow brutal-border bg-black/90 p-8 flex flex-col justify-end">
                        <div id="active-line" class="text-3xl font-bold uppercase tracking-tight italic leading-tight glitch-text"></div>
                    </div>
                    <div class="h-1/3 grid grid-cols-2 gap-6">
                        <button id="choice-0" class="btn-choice p-6 flex flex-col items-start justify-center">
                            <span id="verb-0" class="text-2xl font-black italic uppercase">Investigate</span>
                            <p id="micro-0" class="text-[10px] text-white/50 uppercase">Preserve Proof</p>
                        </button>
                        <button id="choice-1" class="btn-choice p-6 flex flex-col items-start justify-center">
                            <span id="verb-1" class="text-2xl font-black italic uppercase">Reframe</span>
                            <p id="micro-1" class="text-[10px] text-white/50 uppercase">Internal Distress</p>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="screen-end" class="screen flex-col items-center justify-center text-center">
            <div class="brutal-border bg-black p-12">
                <h1 id="end-title" class="text-6xl font-black italic uppercase glitch-text">Terminated</h1>
                <p id="end-headline" class="text-red-600 font-bold mt-4"></p>
                <button onclick="location.reload()" class="mt-8 btn-choice bg-red-600 text-white p-4 uppercase">Retry Protocol</button>
            </div>
        </section>
    </main>

    <script>
        const BASE_URL = "https://dash.cloudflare.com/40ac45ea6cc627df95862ef4e1ce0c56/r2/default/buckets/pixelstortion-assets/objects/audio_islaGameV1/";
        
        const ROUNDS = [
            { t: "Are you sure this isn’t catastrophizing from old trauma?", i: "Don’t paste childhood over my evidence. This is current.", t_vo: "T_VO_R1.mp3", i_vo: "ISLA_VO_R1.mp3", verbs: ["Investigate", "Reframe"], micros: ["Ask for specifics.", "Soften. Thought error."], good: 0 },
            { t: "Past labels matter. Intensity can create false patterns.", i: "Labels don’t move money. Timing does.", t_vo: "T_VO_R2.mp3", i_vo: "ISLA_VO_R2.mp3", verbs: ["Content-First", "Symptom-First"], micros: ["Check events.", "Treat as pathology."], good: 0 },
            { t: "Breaking in and taking data sounds impulsive and risky.", i: "It prevented worse. Authorities rebuilt the trail legally after.", t_vo: "T_VO_R3.mp3", i_vo: "ISLA_VO_R3.mp3", verbs: ["Verify", "Moralize"], micros: ["Test rationale.", "Label as mania."], good: 0 }
        ];

        let state = { idx: 0, trust: 50, strikes: 0, timeLeft: 180 };

        function playAudio(file) {
            const player = new Audio(BASE_URL + file);
            player.play();
        }

        function startGame() {
            document.getElementById('screen-intro').classList.remove('active');
            document.getElementById('screen-game').classList.add('active');
            renderRound();
            startTimer();
        }

        function startTimer() {
            setInterval(() => {
                state.timeLeft--;
                document.getElementById('hud-time').innerText = `0${Math.floor(state.timeLeft/60)}:${state.timeLeft%60}`;
            }, 1000);
        }

        function renderRound() {
            const r = ROUNDS[state.idx];
            document.getElementById('active-line').innerText = r.t;
            playAudio(r.t_vo);
            document.getElementById('verb-0').innerText = r.verbs[0];
            document.getElementById('verb-1').innerText = r.verbs[1];
            document.getElementById('micro-0').innerText = r.micros[0];
            document.getElementById('micro-1').innerText = r.micros[1];

            document.getElementById('choice-0').onclick = () => choose(0);
            document.getElementById('choice-1').onclick = () => choose(1);
        }

        function choose(idx) {
            const r = ROUNDS[state.idx];
            if (idx === r.good) {
                state.trust += 10;
                playAudio(r.i_vo);
            } else {
                state.trust -= 20;
                state.strikes++;
                playAudio("ISLA_VO_STRIKE.mp3");
            }
            
            document.getElementById('hud-trust').innerText = `Stability: ${state.trust}%`;
            document.getElementById('trust-bar').style.width = `${state.trust}%`;
            document.getElementById('hud-strikes').innerText = `${state.strikes}/2`;

            if (state.strikes >= 2 || state.trust <= 0) return endGame("Reality check failed.");
            state.idx++;
            if (state.idx >= ROUNDS.length) return endGame("Witness verified.", true);
            renderRound();
        }

        function endGame(msg, win) {
            document.getElementById('screen-game').classList.remove('active');
            document.getElementById('screen-end').classList.add('active');
            document.getElementById('end-title').innerText = win ? "Success" : "Terminated";
            document.getElementById('end-headline').innerText = msg;
        }

        document.getElementById('btn-start').onclick = startGame;
    </script>
</body>
</html>
